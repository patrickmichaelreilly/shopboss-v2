@model string

@{
    Layout = null;
}

<!DOCTYPE html>
<html>
<head>
    <title>Smartsheet Connection Error</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">
    <div class="container d-flex justify-content-center align-items-center min-vh-100">
        <div class="card text-center" style="max-width: 400px;">
            <div class="card-body p-4">
                <div class="text-danger mb-3">
                    <i class="fas fa-exclamation-triangle" style="font-size: 3rem;"></i>
                </div>
                <h4 class="card-title text-danger">Connection Failed</h4>
                <p class="card-text">
                    @if (!string.IsNullOrEmpty(Model))
                    {
                        @Model
                    }
                    else
                    {
                        <text>Unable to connect to Smartsheet. Please try again.</text>
                    }
                </p>
                <button type="button" class="btn btn-secondary" onclick="window.close()">
                    Close Window
                </button>
            </div>
        </div>
    </div>

    <script src="https://kit.fontawesome.com/your-fontawesome-kit.js" crossorigin="anonymous"></script>
    <script>
        // Auto-close the popup after 5 seconds
        setTimeout(() => {
            if (window.opener) {
                // Notify parent window of failed authentication (same-origin)
                window.opener.postMessage({ type: 'smartsheet-auth-error', error: '@Model' }, window.location.origin);
            }
            window.close();
        }, 5000);
    </script>
</body>
</html>
